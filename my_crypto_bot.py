import ccxt
from pprint import pprint  # –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö

def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω—ã BTC/USDT —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –±–∏—Ä–∂–∏.
    """
    # –°–ø–∏—Å–æ–∫ –±–∏—Ä–∂ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ–ø—Ä–æ–±—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ, –µ—Å–ª–∏ –æ–¥–Ω–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç)
    exchanges_to_try = ['bybit', 'binance', 'kucoin', 'okx']
    
    for exchange_id in exchanges_to_try:
        print(f"\n--- –ü—Ä–æ–±—É–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ {exchange_id}... ---")
        
        try:
            # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –±–∏—Ä–∂–∏
            exchange_class = getattr(ccxt, exchange_id)
            exchange = exchange_class({
                'enableRateLimit': True,
                'timeout': 30000,  # —Ç–∞–π–º–∞—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
            })
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–æ—Ä–≥–æ–≤—É—é –ø–∞—Ä—É
            symbol = 'BTC/USDT'
            
            # –ü–æ–ª—É—á–∞–µ–º —Ç–∏–∫–µ—Ä
            print(f"–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–∏–∫–µ—Ä –¥–ª—è {symbol}...")
            ticker = exchange.fetch_ticker(symbol)
            
            # –£–°–ü–ï–• - –Ω–∞—à–ª–∏ —Ä–∞–±–æ—Ç–∞—é—â—É—é –±–∏—Ä–∂—É
            print(f"‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ {exchange_id}!")
            
            # –í—ã–≤–æ–¥–∏–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ
            print("\nüìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∏–∫–µ—Ä–µ:")
            print(f"–°–∏–º–≤–æ–ª: {ticker.get('symbol', symbol)}")
            print(f"–ü–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞: {ticker.get('last', 'N/A')}")
            print(f"–¶–µ–Ω–∞ bid: {ticker.get('bid', 'N/A')}")
            print(f"–¶–µ–Ω–∞ ask: {ticker.get('ask', 'N/A')}")
            print(f"–û–±—ä–µ–º –∑–∞ 24—á: {ticker.get('baseVolume', 'N/A')}")
            print(f"–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ 24—á: {ticker.get('percentage', 'N/A')}%")
            
            # –í—ã–≤–æ–¥–∏–º –≤–∞–ª—é—Ç—É –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ (–∏–∑–≤–ª–µ–∫–∞–µ–º –∏–∑ —Å–∏–º–≤–æ–ª–∞)
            quote_currency = symbol.split('/')[1]
            print(f"–í–∞–ª—é—Ç–∞: {quote_currency}")
            
            # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è
            print("\nüìã –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –≤ –æ—Ç–≤–µ—Ç–µ:")
            for key, value in ticker.items():
                if key not in ['info']:  # –∏—Å–∫–ª—é—á–∞–µ–º —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç –±–∏—Ä–∂–∏ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏
                    print(f"  {key}: {value}")
            
            # –ï—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ —Å—é–¥–∞ - –≤—Å—ë —Ö–æ—Ä–æ—à–æ, –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞
            break
            
        except AttributeError:
            print(f"‚ùå –ë–∏—Ä–∂–∞ '{exchange_id}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ CCXT")
            continue
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ {exchange_id}: {type(e).__name__} - {e}")
            continue
    else:
        # –≠—Ç–æ—Ç –±–ª–æ–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ –Ω–∏ –æ–¥–Ω–∞ –±–∏—Ä–∂–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞
        print("\n‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∏ –∫ –æ–¥–Ω–æ–π –±–∏—Ä–∂–µ.")
        print("\nüìå –î–æ—Å—Ç—É–ø–Ω—ã–µ –±–∏—Ä–∂–∏ –≤ CCXT:")
        print(', '.join(ccxt.exchanges[:20]))  # –ø–æ–∫–∞–∂–µ–º –ø–µ—Ä–≤—ã–µ 20

if __name__ == "__main__":
    print("üöÄ –ó–∞–ø—É—Å–∫ –∫—Ä–∏–ø—Ç–æ-–ø–æ–º–æ—â–Ω–∏–∫–∞")
    print("=" * 50)
    main()
    print("=" * 50)